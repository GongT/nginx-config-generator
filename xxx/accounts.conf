###   GENERATED FILE ; DO NOT MODIFY   ###

proxy_cache_path /tmp/accounts_cache levels=1:2 keys_zone=accounts_cache:2m inactive=60m;

### createUpstream: 
#       serviceDockerRunning=true
#       wantServiceToRun=true
#       direction=up
upstream accounts_service_upstream_up_80 {
	# self: docker - 38edf0ed2c99
	server 38edf0ed2c99:80 weight=200 fail_timeout=5s; # server in docker
	keepalive 16;
}

### createUpstream: 
#       serviceDockerRunning=true
#       wantServiceToRun=true
#       direction=down
upstream accounts_service_upstream_down_80 {
	# self: docker - 38edf0ed2c99
	server 38edf0ed2c99:80 weight=200 fail_timeout=5s; # server in docker
	keepalive 16;
}
### createHttpDownServer
server {
	server_name accounts user-center accounts.localhost.vm;
	listen 81;
	listen [::]:81;
	# section: body
	# -> accounts
	proxy_set_header Host accounts.localhost.vm;
	include generated.d/sub-configs/public-body.conf;
	## extraBodies
	location /public {
		proxy_cache_key "accounts$request_method$request_uri";
		
		more_set_headers       "X-Cache-Reason: static:fedora.work:/public";
		
		proxy_set_header       Host accounts.localhost.vm;
		proxy_cache            accounts_cache;
		proxy_cache_valid      200  3h;
		
		include generated.d/sub-configs/cache.conf;
		
		proxy_pass             http://accounts_service_upstream_down_80$request_uri$is_args$args;
		break;
	}
	## createBody END
	# section: main
	## createMainBody
	location / {
		## no section: extra bodies
		## no section: manual set body
		# section: main bodies
		# createPassthru(accounts, down)
		proxy_set_header Connection "";
		proxy_set_header Host accounts.localhost.vm;
		proxy_pass http://accounts_service_upstream_down_80;
	}
	## createMainBody END
}
### createHttpDownServer END
### createHttpUpServer
server {
	server_name accounts user-center accounts.localhost.vm;
	listen 80;
	listen [::]:80;
	# section: body
	# -> accounts
	proxy_set_header Host accounts.localhost.vm;
	include generated.d/sub-configs/public-body.conf;
	## extraBodies
	location /public {
		proxy_cache_key "accounts$request_method$request_uri";
		
		more_set_headers       "X-Cache-Reason: static:fedora.work:/public";
		
		proxy_set_header       Host accounts.localhost.vm;
		proxy_cache            accounts_cache;
		proxy_cache_valid      200  3h;
		
		include generated.d/sub-configs/cache.conf;
		
		proxy_pass             http://accounts_service_upstream_up_80$request_uri$is_args$args;
		break;
	}
	## createBody END
	# section: main
	## createMainBody
	location / {
		## no section: extra bodies
		## no section: manual set body
		# section: main bodies
		# createPassthru(accounts, up)
		proxy_set_header Connection "";
		proxy_set_header Host accounts.localhost.vm;
		proxy_pass http://accounts_service_upstream_up_80;
	}
	## createMainBody END
}
### createHttpUpServer END
